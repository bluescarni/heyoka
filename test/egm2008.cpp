// Copyright 2020-2025 Francesco Biscani (bluescarni@gmail.com), Dario Izzo (dario.izzo@gmail.com)
//
// This file is part of the heyoka library.
//
// This Source Code Form is subject to the terms of the Mozilla
// Public License v. 2.0. If a copy of the MPL was not distributed
// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.

#include <cmath>
#include <stdexcept>
#include <vector>

#include <boost/math/constants/constants.hpp>

#include <fmt/core.h>

#include <heyoka/detail/debug.hpp>
#include <heyoka/detail/egm2008.hpp>
#include <heyoka/expression.hpp>
#include <heyoka/kw.hpp>
#include <heyoka/model/egm2008.hpp>

#include "catch.hpp"
#include "test_utils.hpp"

using namespace heyoka;
using namespace heyoka_test;

TEST_CASE("error handling")
{
    using Catch::Matchers::Message;

    const auto [x, y, z] = make_vars("x", "y", "z");

    REQUIRE_THROWS_MATCHES(
        model::egm2008_pot({x, y, z}, model::detail::egm2008_max_degree + 1u, 0), std::invalid_argument,
        Message(fmt::format("Invalid degree specified for the EGM2008 geopotential model: the maximum degree is "
                            "{}, but a degree of {} was specified",
                            model::detail::egm2008_max_degree, model::detail::egm2008_max_degree + 1u)));

    REQUIRE_THROWS_MATCHES(model::egm2008_pot({x, y, z}, 0, 1), std::invalid_argument,
                           Message("Invalid combination of degree and order specified for the EGM2008 "
                                   "geopotential model: the order 1 is greater than the degree 0"));

    REQUIRE_THROWS_MATCHES(
        model::egm2008_acc({x, y, z}, model::detail::egm2008_max_degree, 0), std::invalid_argument,
        Message(
            fmt::format("Invalid degree specified for the computation of the acceleration in "
                        "the EGM2008 geopotential model: a degree of {} is too high, the maximum allowed value is {}",
                        model::detail::egm2008_max_degree, model::detail::egm2008_max_degree - 1u)));
}

// A test to check that custom mu/a are correctly forwarded.
TEST_CASE("custom params")
{
    const auto [x, y, z] = make_vars("x", "y", "z");

    REQUIRE(model::egm2008_pot({x, y, z}, 0, 0) != model::egm2008_pot({x, y, z}, 0, 0, kw::mu = "mu"_var));
    REQUIRE(model::egm2008_pot({x, y, z}, 0, 0) != model::egm2008_pot({x, y, z}, 0, 0, kw::a = "a"_var));
    REQUIRE(model::egm2008_pot({x, y, z}, 0, 0) != model::egm2008_pot({x, y, z}, 0, 0, kw::mu = 1.2_dbl));
    REQUIRE(model::egm2008_pot({x, y, z}, 0, 0) != model::egm2008_pot({x, y, z}, 0, 0, kw::a = 1.1_dbl));
}

TEST_CASE("potential")
{
    using std::cos;
    using std::sin;

    detail::edb_disabler edb;

    const auto [x, y, z] = make_vars("x", "y", "z");

    // NOTE: up to order 1 only the Keplerian term must survive.
    REQUIRE(model::egm2008_pot({x, y, z}, 0, 0) == model::egm2008_pot({x, y, z}, 1, 0));
    REQUIRE(model::egm2008_pot({x, y, z}, 0, 0) == model::egm2008_pot({x, y, z}, 1, 1));

    // Run a computation up to the max degree/order.
    REQUIRE_NOTHROW(
        model::egm2008_pot({x, y, z}, model::detail::egm2008_max_degree, model::detail::egm2008_max_degree));

    // Prepare input/output for the compiled functions.
    std::vector<double> out(1), in(3);

    // A simple test with J2 only, computed manually.
    {
        auto cf = cfunc<double>({model::egm2008_pot({x, y, z}, 2, 0)}, {x, y, z});
        // Pick some longitude (irrelevant) and colatitude.
        const auto phi = 42.;
        const auto theta = 0.123;
        // Pick a radius.
        const auto r = 6378137.0 + 1000.0;

        const auto X = r * sin(theta) * cos(phi);
        const auto Y = r * sin(theta) * sin(phi);
        const auto Z = r * cos(theta);

        in[0] = X;
        in[1] = Y;
        in[2] = Z;

        cf(out, in);

        REQUIRE(out[0] == approximately(62418910.63181418));
    }

    // A simple test up to C22/S22, computed manually.
    {
        auto cf = cfunc<double>({model::egm2008_pot({x, y, z}, 2, 2)}, {x, y, z});
        const auto phi = 42.;
        const auto theta = 0.123;
        const auto r = 6378137.0 + 1000.0;

        const auto X = r * sin(theta) * cos(phi);
        const auto Y = r * sin(theta) * sin(phi);
        const auto Z = r * cos(theta);

        in[0] = X;
        in[1] = Y;
        in[2] = Z;

        cf(out, in);

        REQUIRE(out[0] == approximately(62418905.70696879));
    }

    // Test with n=2, m=1.
    {
        auto cf = cfunc<double>({model::egm2008_pot({x, y, z}, 2, 1)}, {x, y, z});
        const auto phi = 42.;
        const auto theta = 0.123;
        const auto r = 6378137.0 + 1000.0;

        const auto X = r * sin(theta) * cos(phi);
        const auto Y = r * sin(theta) * sin(phi);
        const auto Z = r * cos(theta);

        in[0] = X;
        in[1] = Y;
        in[2] = Z;

        cf(out, in);

        REQUIRE(out[0] == approximately(62418910.596871205));
    }

    // A simple test up to C33/S33, computed manually.
    {
        auto cf = cfunc<double>({model::egm2008_pot({x, y, z}, 3, 3)}, {x, y, z});
        const auto phi = 42.;
        const auto theta = 0.123;
        const auto r = 6378137.0 + 1000.0;

        const auto X = r * sin(theta) * cos(phi);
        const auto Y = r * sin(theta) * sin(phi);
        const auto Z = r * cos(theta);

        in[0] = X;
        in[1] = Y;
        in[2] = Z;

        cf(out, in);

        REQUIRE(out[0] == approximately(62419001.277551234));
    }

    // Test with n=3, m=0.
    {
        auto cf = cfunc<double>({model::egm2008_pot({x, y, z}, 3, 0)}, {x, y, z});
        const auto phi = 42.;
        const auto theta = 0.123;
        const auto r = 6378137.0 + 1000.0;

        const auto X = r * sin(theta) * cos(phi);
        const auto Y = r * sin(theta) * sin(phi);
        const auto Z = r * cos(theta);

        in[0] = X;
        in[1] = Y;
        in[2] = Z;

        cf(out, in);

        REQUIRE(out[0] == approximately(62419061.693081796));
    }

    // Test with n=3, m=1.
    {
        auto cf = cfunc<double>({model::egm2008_pot({x, y, z}, 3, 1)}, {x, y, z});
        const auto phi = 42.;
        const auto theta = 0.123;
        const auto r = 6378137.0 + 1000.0;

        const auto X = r * sin(theta) * cos(phi);
        const auto Y = r * sin(theta) * sin(phi);
        const auto Z = r * cos(theta);

        in[0] = X;
        in[1] = Y;
        in[2] = Z;

        cf(out, in);

        REQUIRE(out[0] == approximately(62419011.00138944));
    }

    // Test with n=3, m=2.
    {
        auto cf = cfunc<double>({model::egm2008_pot({x, y, z}, 3, 2)}, {x, y, z});
        const auto phi = 42.;
        const auto theta = 0.123;
        const auto r = 6378137.0 + 1000.0;

        const auto X = r * sin(theta) * cos(phi);
        const auto Y = r * sin(theta) * sin(phi);
        const auto Z = r * cos(theta);

        in[0] = X;
        in[1] = Y;
        in[2] = Z;

        cf(out, in);

        REQUIRE(out[0] == approximately(62419001.00066965));
    }
}

// NOTE: see the notebook in the tools/ directory for the code
// used to produce this test data.
constexpr double test_positions[500][3] = {{978125.317043621, 6822270.629334903, 3164079.590512845},
                                           {-1569989.6817824303, 3520795.343999458, 12039708.430265158},
                                           {1292711.0216009682, -4214697.109602783, -4771726.087599893},
                                           {-1979180.5704285156, -3961252.827307108, -6057308.56166768},
                                           {-4804002.920050053, 3918127.6115223602, 5497157.758521708},
                                           {-3540786.1547283176, 6179306.159116686, -3563697.7601554366},
                                           {-3214406.4819400143, -2283612.717795085, 5493919.029997353},
                                           {3427958.675251635, 8164485.401857106, 1281269.2824156766},
                                           {-3611557.474092803, -6847661.514735896, 1608603.9164836602},
                                           {1086669.6513247874, -416066.79103907157, -8421190.042419286},
                                           {77170.28176520791, 7000876.027255802, 937815.4996408926},
                                           {7578149.1274710335, -2521323.8598936144, 8813066.554738281},
                                           {-887357.04601899, -1549756.6266520817, 11250770.938129457},
                                           {5178272.186806492, 3562023.4823448826, -1545595.7357321146},
                                           {-4595289.21824026, 1758237.6008927193, -4369946.752087857},
                                           {4739197.89781423, -4100479.783797684, 8582807.807233766},
                                           {-2588232.2267534696, -7552406.631084927, -1387627.7020203774},
                                           {-3977812.814993946, 7631473.461704249, -825127.0231526996},
                                           {-953102.1940333862, -9406202.816537272, -584140.4284266774},
                                           {2303907.600543176, 12133394.522062505, 1176982.7798056891},
                                           {2972279.821457747, 1673020.1232884133, -6278922.406445427},
                                           {1138692.4622782983, 1791693.3386426882, -8405434.130259838},
                                           {-5097074.381599823, 8020539.942073584, 6004877.971593299},
                                           {-9538911.781994415, 2120047.657684589, 2688384.93341052},
                                           {-876898.098773769, 8468841.355246771, -1844107.656760635},
                                           {3680357.2958994964, -8392242.95990566, 2978019.8095408096},
                                           {2084581.8882522017, 5601076.419227066, 2810753.6914841994},
                                           {5369274.559670522, 5679609.156943638, -3593576.771246461},
                                           {8847216.230571274, 5745298.043819843, -2334234.7870886885},
                                           {-4559428.323169298, -3250346.161161984, -3277735.0801764475},
                                           {4003974.3499533897, -5179213.5836385125, -6866242.704933813},
                                           {-5909574.874364592, -4386221.21842666, 1374615.8907851563},
                                           {6071292.136939269, -2764824.2582910475, 3603990.6740473113},
                                           {-1279010.6252803025, -8004173.918841702, 1790603.329082891},
                                           {4326846.579041972, -5193523.774229954, -3791444.941312201},
                                           {6147915.699944612, -2924294.8708598306, 2007446.0365903112},
                                           {-7723976.583994904, -2306575.90596223, -1457169.3225390937},
                                           {10342844.347481225, -4270983.960259931, -1203279.9110223018},
                                           {-2290370.4085409744, 72151.51378789342, -9835279.33648237},
                                           {-1396555.814430065, 9279919.75677062, 6311432.857526593},
                                           {-6789501.112166109, 2122452.809951853, 9316758.878227778},
                                           {-5061669.108839406, -8563594.275613228, -4561169.819436419},
                                           {-3592937.97379287, 6449741.6294871215, -2122418.794183396},
                                           {7242250.115861095, -5025355.556395404, -150046.19281921998},
                                           {-360158.1739446698, 8097509.269121763, -1692662.466392275},
                                           {-5765697.092641386, 9106981.71586949, -2916351.1793071446},
                                           {-499259.7569375332, 8965786.34667122, 5073770.03776227},
                                           {-6086695.61083847, 7801630.161623878, 3193413.9484088956},
                                           {11123344.781006264, 351127.6451508312, -4270967.156441601},
                                           {-5252910.625831334, -5496402.911105241, 2124655.7966011884},
                                           {-1523412.9951619452, 7383682.118519125, 2974877.8217202746},
                                           {9538693.162749626, 4349359.0091250185, -1265619.1230880239},
                                           {-7689656.204250088, -6938010.548933955, -5643648.313156605},
                                           {1980991.2666136862, 3969345.1907828893, 4680731.824052772},
                                           {-617669.7643347492, 1736553.4740377103, -12055844.043777391},
                                           {-6770000.442580628, 2636892.6471237116, 3545913.9624775127},
                                           {3896557.0822134763, 5377514.489334829, 5219372.820597046},
                                           {1709976.5077201894, 8370690.490104573, -6053076.276938522},
                                           {-11942375.656457672, 1942816.61110714, 1710786.8370265015},
                                           {-1783558.0288001928, 266784.0595703995, 6555332.911693859},
                                           {-282540.7473929853, 8591077.027816923, -3716143.9151185635},
                                           {-3309376.2034930657, 10741619.479486628, 2660790.5167875146},
                                           {-1707191.9015710657, 9243445.264764799, -1646838.9507682365},
                                           {-673690.5511010569, 10120150.154316945, -1204809.2980763684},
                                           {-9382895.564103305, 1020274.0968398539, 5528387.454006194},
                                           {2446981.250418933, 10047410.558632493, 937650.3614119575},
                                           {-5791133.731731905, 159028.41380819125, -2879545.2870050287},
                                           {247843.73732618577, 10548739.548574805, 5817811.733006397},
                                           {4161062.6391499583, -6697069.349322408, 940984.9549072998},
                                           {3574368.262174648, 7612125.302368999, -3498957.5677107153},
                                           {7474831.946502437, -8790272.957935363, 2283502.872980589},
                                           {3280312.044781863, 6781965.712385811, 4172167.538105343},
                                           {14981.019863856734, -4487391.663917482, -7992838.168897355},
                                           {-5832911.904585269, -4894974.619879846, -6856175.6238460755},
                                           {2089061.7983865975, 7960659.576998717, -2538220.086217487},
                                           {437224.96021867666, -7039533.5992530715, -4088461.0942398086},
                                           {44683.01050821822, 9617497.73998761, 1288210.1188067107},
                                           {2790092.691449732, 1663613.4327468432, -6780869.130501333},
                                           {-3608535.5633810535, -3306662.29626614, 7434103.850154877},
                                           {-6641681.321741548, -1571079.4831395866, 3642552.9083903767},
                                           {-4693055.647371464, -5291422.262186112, -1152607.3603221597},
                                           {4127859.788482776, 8023223.003709391, -8750292.843807384},
                                           {65053.8703875886, 5640495.1164472895, -10171641.475383604},
                                           {-4367747.604218025, -10062548.620875398, 5976130.475274036},
                                           {7827714.874859485, 4359318.643544963, 1202415.5923403993},
                                           {5604849.13879007, -5599667.641126244, -1365825.848771532},
                                           {-10137636.804301282, 4872384.193506736, -4509935.132400224},
                                           {-2667225.2819872554, -2454522.454374636, -7139375.238541518},
                                           {-3013640.859754377, 7197994.285416142, 4711019.347138278},
                                           {3640848.7205618736, 7608109.388163401, -5979865.718378255},
                                           {6833008.024048937, 417489.6701273575, -3591554.59153142},
                                           {1989943.3314484744, 7759011.373338838, -5062314.971129559},
                                           {7750575.0942524215, -8253453.636767906, 1516413.711542097},
                                           {9129097.16096649, -1573795.9043829602, -4278095.370805212},
                                           {-4945114.26729401, 1893772.5752274056, -6655279.915206247},
                                           {-3516161.469803765, 3354272.5390096484, 5435247.680227178},
                                           {-1134328.3250594104, 6896022.448590848, -6031902.503775563},
                                           {7520169.54838998, -1626264.5196148215, -5310161.433454789},
                                           {6670818.551009129, 2554402.5826239083, 3917660.6388948997},
                                           {-7417679.930266027, 4790598.615428303, -723352.9926791055},
                                           {2126860.870336175, 3791011.189505024, 7651082.331604698},
                                           {268889.06486481184, 4336501.416570201, 5588373.02155972},
                                           {2260193.7463844786, -11845173.81557868, 1478038.4051793315},
                                           {2429608.5292296186, 8127331.199120066, -7702096.038020222},
                                           {-8952146.343845384, -3036813.254061345, -3936073.853572413},
                                           {-5076293.438216624, 5614519.856916621, 2623015.6045650896},
                                           {-9057373.293409279, -414686.0019643219, -4022717.595032818},
                                           {-4360872.364512222, 7541816.245096239, 223861.87964183636},
                                           {-1033856.4259598581, 4957521.195142666, -5838878.021681456},
                                           {-1610095.0120220305, 7943024.2293961635, 998123.6577598345},
                                           {4050287.173629524, 2408448.936150837, 8892100.189025285},
                                           {-7983867.705395732, 916293.5148280025, 2029903.477844504},
                                           {7030350.044533395, -6329390.900829766, -4452537.770072275},
                                           {7174813.295520002, -2470206.792843609, -9114273.089717751},
                                           {10716436.363679525, 1862250.7018750024, 2176214.4154902603},
                                           {10396646.780488903, -5908323.786941213, 1240214.48344096},
                                           {7458863.683371507, 7140016.876712137, 6130614.858720824},
                                           {-13027.737344770963, -963322.9560370047, -11136982.93305057},
                                           {5418369.934427939, -4120602.285767741, -6597714.71845453},
                                           {3728608.359139641, 6578159.902879996, 1787108.5723027634},
                                           {-3257980.0307705426, 5799304.138215303, 1002425.0974219098},
                                           {-5820178.223530523, 5593768.160834455, 3576003.1913876394},
                                           {-2508796.055707635, 3600876.8292920743, 5614749.61013275},
                                           {-5981764.766167229, -613096.4341192703, 3818358.998442048},
                                           {8059270.650827927, 455924.01298055635, 1831757.3651087568},
                                           {-1155542.2495900225, 610172.5366872352, 8455927.771864817},
                                           {8565729.71990488, -8284324.390314359, -4116093.3755668947},
                                           {5307533.91641126, 3248111.7926248787, -3770868.411561069},
                                           {-9125613.664138634, 915597.3985292164, -4788642.243754845},
                                           {-6309288.644771528, 747648.8472250507, 1686293.3846067647},
                                           {1550645.3064890672, -7470881.778747437, -8949687.409380864},
                                           {6782282.882294608, -1535738.2476204752, -1303186.7078638645},
                                           {-2241725.666015416, -8113483.045015248, -2757922.573430449},
                                           {-916316.4325761771, 6098289.018217128, -7245155.586980262},
                                           {-4139884.8897153195, -7543137.548348927, 7520336.889505542},
                                           {-4038165.998694448, 5743059.109193714, 6298114.650807933},
                                           {802303.1978433857, -7013404.719835168, -4045348.4418080538},
                                           {-2937133.3616670487, -5834184.192551732, -9418140.606705187},
                                           {7331389.97209082, -1041906.1121068061, 1948381.8859329002},
                                           {6762196.696891111, -7506089.336000719, -7421097.979818307},
                                           {9932189.415600898, 2960703.8532107063, 1755641.8245526245},
                                           {-1598493.82449409, 6173565.878381404, -1428772.199521736},
                                           {5614004.625033661, -6582269.719252061, 9011423.948339185},
                                           {-8871950.077755546, -6518339.819211652, -4474061.20477916},
                                           {-4278727.084922844, 6359534.771061163, 303512.59679588134},
                                           {6516663.465535206, 2374052.119418247, -10559973.821619818},
                                           {704492.2022449385, -8691189.445419207, -2455893.20500322},
                                           {7470400.369400032, 71290.88602148216, 10164422.828618169},
                                           {5687572.674395269, 3753635.928121433, -6856375.140765364},
                                           {7732072.552675683, -315756.55001425307, 4536453.011209167},
                                           {1415536.6094137225, -8583371.956016012, -867889.9008225575},
                                           {7459432.477236555, -8118465.209034262, 1430380.8331604518},
                                           {-6862881.304756685, 991772.209574868, 8905758.296081886},
                                           {3378242.5321536264, 6041065.434099317, 9309623.658901388},
                                           {-10947084.527303593, -2373211.1504577217, -1449259.5740970678},
                                           {-1026363.1872319125, 516218.673911078, 7225431.744338559},
                                           {3145680.6248845356, 5171835.2460334385, -2892252.8151928866},
                                           {3483535.3103118287, 5965161.886791623, -4600363.141313494},
                                           {-422527.379108434, 8243820.950032373, 1972657.3062839864},
                                           {8155298.265359163, -3047037.8671031445, 1600627.8245119315},
                                           {9966725.577311285, -828083.618348702, 414117.8638957318},
                                           {-2151169.481767749, -7179284.011037899, -3134733.828393947},
                                           {-2096384.8939008638, -12311795.091536772, -1679286.360927815},
                                           {-960150.1368146419, -8695832.715535065, 816222.4332484438},
                                           {-2480768.422547495, -272231.08699498646, -7344183.896269216},
                                           {1937709.9103282015, 3950726.8583850893, -7767137.74050009},
                                           {2557636.0771691496, -2473969.825934199, -8522536.114312103},
                                           {5306555.067044278, -4958750.500371015, 6697330.2967615975},
                                           {-1849805.3482582243, -7118030.804877692, 1816685.1345567221},
                                           {7823015.981145497, -3477409.4918091535, -3446239.9439480323},
                                           {12139637.61094558, -1533735.4301128662, 1843104.5804604492},
                                           {-4735215.16325535, -103428.72817279784, 5445809.367317824},
                                           {327033.01348207914, -6870945.48161441, -9196733.319240678},
                                           {-4683207.980283992, -4214214.961011122, -4817047.601351186},
                                           {5981577.778572726, 5266065.032726778, -2884604.9658624413},
                                           {-4839814.543752995, 10996268.00109299, -1008349.7047694859},
                                           {8143346.734308848, 3691279.06854179, -2647363.900105561},
                                           {6680048.768161304, -5751100.726359046, 8565391.856784122},
                                           {6376928.605272264, 890016.3751245197, 588548.1921594035},
                                           {-5118191.84725599, -1221516.812207236, -8388960.407422308},
                                           {2650973.499536699, 5420971.9208408585, -3248198.093265906},
                                           {5787849.813095701, 7657955.111084123, 138175.49399750071},
                                           {4835750.916225982, 8276726.570363715, 5804018.698208272},
                                           {5041268.244304519, -4918978.048937981, 1876674.7098423578},
                                           {-963293.472771239, 33483.324255513, 7727801.02385915},
                                           {-5932887.711260651, 9232849.804304907, -4167534.4024232547},
                                           {10845157.582332784, -53844.59367452139, 2679192.1665959894},
                                           {-3798402.028865465, -1128813.8885487288, 9201941.524648247},
                                           {-3314364.1868770546, 9517982.612785524, -1062283.7641602808},
                                           {-3856553.008358643, 4073258.658579034, -5171966.137754105},
                                           {-2714093.575606737, -7669500.671232052, -5225722.153631295},
                                           {8646468.99120309, 8144819.609238811, -2353695.355152719},
                                           {311762.87039129465, -6030084.845439901, -6858238.345336887},
                                           {5082644.018636616, -4551382.443216828, -339480.9506643888},
                                           {-4170407.538992307, 657005.4727487465, 11635866.165457228},
                                           {-6861453.204891883, 2851976.073824649, 8593581.478573762},
                                           {4183535.7315591974, 5263443.872901369, 1318611.0380754557},
                                           {-3889587.537333656, 2051856.3603666634, 7908247.49192378},
                                           {642288.8184306223, -7073692.34584152, 1890019.0970920036},
                                           {-5612661.773315506, 3367897.966160762, -10077274.42270885},
                                           {-7318980.685528977, -6867008.856902793, 3260788.8222177126},
                                           {11658797.731668996, 3290452.5546107274, 2175412.6827601646},
                                           {1695680.4918597292, 8806483.080516567, 2729217.0013753395},
                                           {3183044.9979310995, 10662585.631973965, -6107725.319064889},
                                           {6032257.575890206, -716904.8923930731, 3194903.3286333214},
                                           {7540173.144940046, 2167516.8450362673, 529763.1315696127},
                                           {890479.4897829489, 4021562.263489067, 10771818.126137258},
                                           {6657866.958830681, 1330823.1423009923, -7539801.2922387365},
                                           {-7826195.214922168, -9404196.599723697, 624467.754094984},
                                           {-3547322.9426167025, -5092797.238998333, 6182275.580213396},
                                           {-2694435.141131041, 3936930.058617, -4255428.036692259},
                                           {7654514.413341935, 1779519.1545859901, 5093369.966606373},
                                           {-3295245.8724598745, 1425723.492199282, 6309412.433081851},
                                           {3080646.935124587, 5716196.723385442, 3513600.228774578},
                                           {-6605382.960805163, 3275963.083395004, 2374450.812876473},
                                           {-4403635.527788606, 4526509.472062272, -4350462.029596542},
                                           {845084.454740779, 4600469.666944199, 7768148.069402489},
                                           {2986486.8264698535, -4600413.963980876, -8333708.710820159},
                                           {-3959220.58557363, -10500723.595525865, -3128357.718010148},
                                           {-2958619.731864237, 551966.1319817568, -5827984.090396525},
                                           {-5459777.049066704, 3983277.6713780314, -444292.18826592667},
                                           {5847791.793465152, 4778588.25413026, 4061994.3889706824},
                                           {-7228821.310925813, -5465900.65449028, 34165.090338352595},
                                           {-5929425.523652873, -154718.7815285196, -3727075.3248320227},
                                           {9019506.266298313, -6098131.897437211, 2953681.7193428515},
                                           {6899334.89356357, -1365157.7385164124, 3815727.103990139},
                                           {4035164.2593995035, -10267868.303390147, -6246617.817798897},
                                           {6626119.835426308, -7356300.207229928, -3621060.5454566167},
                                           {-5509434.106794216, 145780.19000835717, -3999270.6159221055},
                                           {-8497845.075097742, 8628895.028319383, -1135109.6545849417},
                                           {-4320691.146795215, 573704.3649205369, -8168330.457556019},
                                           {-11123743.305571243, -2212110.651728629, -1914947.3650515466},
                                           {2521580.666257089, -5566320.618843612, -9128912.031952837},
                                           {4203506.973075518, 5863239.673637505, -3935391.1580567826},
                                           {-1445954.3596823774, -1058325.2048089977, 9357415.764772508},
                                           {2825460.2385059646, -1894601.5730754232, -5767259.905459216},
                                           {1041374.286781695, 5958851.237043405, -2717722.3779706615},
                                           {-1951953.916627715, 8049492.591165799, -2039807.9055062719},
                                           {5023838.207310778, -7678032.002458895, 8086337.167593591},
                                           {-4060145.419404741, -5728504.688289758, -8554111.074277407},
                                           {5689113.122352853, -1254228.6804052189, 9630032.657320572},
                                           {-5098670.3972119205, -6330179.740503005, 4022382.990255752},
                                           {7157694.971438637, -2358890.797287074, 9952062.416355403},
                                           {3567020.1581202736, -6804147.221257973, 6386631.930257923},
                                           {-4593999.575713149, -8969923.273569731, 1795511.9437760878},
                                           {1993928.9857567628, 5034957.343637426, -10801847.267124481},
                                           {1055979.2606984281, 4527757.140968486, 6353742.250706591},
                                           {5009640.309861081, -5826157.532612465, 1298696.0887835107},
                                           {-3727259.2758477135, 6400830.423951104, -6525868.064503249},
                                           {-1622256.9822832455, -3843579.076881252, 8922061.267700804},
                                           {-7086900.990706228, 3046933.090259832, -7004419.77317428},
                                           {-5391428.445583967, 1407823.7446978348, -4277887.813789674},
                                           {7969635.289985481, 530322.583326616, 1722165.0124705834},
                                           {3097246.6150561743, -6340160.386179809, 3814444.7646699506},
                                           {-2420632.1286020773, 5954795.212106925, -6987143.855716577},
                                           {-5154586.390217284, 8455169.24838489, -2146644.7012339314},
                                           {8176953.127402888, 3948789.3124976866, -936773.8599123925},
                                           {-8501342.198448919, -8461595.461547352, -1018393.906540767},
                                           {1608348.4336992241, -8849841.261859242, -377412.90893818357},
                                           {-9730199.86712967, -676110.7836432322, -942899.6605872546},
                                           {-1857909.5598537205, 261920.43841751252, -6904458.919684609},
                                           {654594.4130511596, -4682247.840675195, 8323678.689699555},
                                           {10096832.069926314, 7022783.15851246, 1928526.0520623904},
                                           {-10636383.598842194, -2796475.7247767244, 4975013.068531141},
                                           {-42828.96474173497, -6105946.774751962, 2102745.684213076},
                                           {-3433568.160203551, 3830703.306258915, 11556190.135616347},
                                           {7033396.991380359, -6934183.705659168, 1066789.8346035136},
                                           {-10668245.108957175, 2967899.547850387, -3415279.7334055677},
                                           {5058551.348030427, 4510601.513535678, 3972548.283605074},
                                           {5189074.508397203, -758806.6212593078, -4322316.661725947},
                                           {-11383057.053622644, 3237338.028811593, 2273139.226064897},
                                           {146225.94319438803, -8343179.022717657, 4534293.601658272},
                                           {7028262.570187519, 3763966.817472512, 1116277.5458326165},
                                           {2126504.341617352, -5487409.099634376, 5491146.450593502},
                                           {3567981.7396410266, 5042994.750095092, -6285502.423691131},
                                           {4281412.876292141, 4279061.577700329, 4897604.34779152},
                                           {-612173.5141879998, 3651521.751379914, 7044403.311069368},
                                           {-6512476.057683475, 3333368.1775161545, 7160028.977564488},
                                           {-11861655.734012788, 1099778.6514769427, -2929579.5024838718},
                                           {-6803125.56478864, 3290911.538736596, -7283207.590235301},
                                           {9381990.879761426, 2068641.1778280959, 1887938.0806108308},
                                           {-5325099.222142789, -3719160.672962122, -3556205.068492056},
                                           {-296690.22019248485, -5867571.745620889, 2584244.176671489},
                                           {10899455.750887675, -1463709.4366587277, -4362406.774065358},
                                           {-10038327.438102115, -3554281.294755284, 5197135.507843709},
                                           {10600079.603884399, -4836846.745525109, -2618668.0958277225},
                                           {7146949.866989385, -2224959.8152142805, -365862.52492785774},
                                           {873687.3458043693, 3628656.7436600495, 5377193.567501177},
                                           {8435999.190111224, 3737751.459461306, -1920824.997029014},
                                           {2001743.6320777785, 3622906.0562531915, -8287995.29459368},
                                           {-129086.20033128689, -3689219.5216448703, 8911198.773543827},
                                           {-559976.7053162709, 8112049.743625882, -7335898.842964053},
                                           {8229863.038801622, 7005596.203347109, -4950482.097343539},
                                           {7567709.890407957, -2811471.674937315, 5047967.157074129},
                                           {-207767.9498147894, -468682.34503854247, -11314972.327436497},
                                           {5305546.574202707, -1427106.493326754, 3309583.35956732},
                                           {-3703492.352467273, 6786056.192843024, -123322.59554535495},
                                           {2654904.4696397446, 6993859.006950489, 2694553.2240770357},
                                           {5467107.1762400605, 6343537.037502199, -2902487.272556259},
                                           {10231218.576217119, -3801710.1242486537, -4672898.698805804},
                                           {1590393.5995823466, 2657298.1698462293, 6818710.321077059},
                                           {2324040.1133499113, -6808598.353835285, 9232979.260318616},
                                           {1692823.4163805295, 6895013.761757009, 2053478.4862491314},
                                           {4581811.525072398, -5336078.403648829, -2232737.864946551},
                                           {4883659.961549294, 1816493.173703712, -6948830.510378072},
                                           {-3443809.442444272, 3176713.432022579, -8168887.8629016895},
                                           {-8629540.187837722, 6111149.924470626, -5366780.243391523},
                                           {8854686.007286618, -1331691.0075630755, 4765224.056842525},
                                           {5765181.265439488, -4315757.316314659, -3975170.379860294},
                                           {-4810809.024918222, 4270836.770238331, -3555014.6727156085},
                                           {-8907673.776929686, 4561069.150161582, 552476.0163376348},
                                           {-2066338.8956736184, -9284105.401602287, 6076832.42389119},
                                           {-1577123.2700754502, -1909206.4775241718, 8857288.454330897},
                                           {2402536.7446031617, -1884174.6042890155, 7199566.651329322},
                                           {-3162383.5450376947, -7593312.5490040295, 1161872.8240309737},
                                           {-8808893.878774652, -850104.5488802834, 2699868.9042086466},
                                           {9142928.97828322, -6582856.223055509, -3976356.834522315},
                                           {-4226650.247265403, 7575975.0683451705, -8549428.778867789},
                                           {-4582588.687537285, 5039602.261040325, 1820899.873247418},
                                           {-2933243.8765777503, 3961781.6708222697, -4735321.588329688},
                                           {-5117526.262438286, 337727.21272365074, 6396699.779936442},
                                           {4424528.600815403, 981104.5044858903, -4503313.296481364},
                                           {-8758947.32940255, 2670119.2153252875, 3265790.6098837233},
                                           {-2292889.2997591156, 5154192.256524919, -11135612.336174125},
                                           {446949.48145996453, 10431571.93362165, 4216757.1312614465},
                                           {107698.96100701514, 6661071.427364787, -5061959.191439933},
                                           {1818893.1773169886, -5906575.259332957, 2017751.6689507414},
                                           {-5802813.588772781, 5077692.817569152, 7141808.378102375},
                                           {3487782.171841418, -424057.68951376254, -10508491.852939801},
                                           {-9665991.770584958, 5902308.054349349, -3649018.689457849},
                                           {-2580607.542083905, -7569505.88938345, -8767287.140055755},
                                           {-3346990.808208366, 9228762.443591818, -5094176.16508948},
                                           {4364117.661662508, -8369647.358863398, -2976325.2387696486},
                                           {679684.2361007154, 2876427.0798852365, 8301494.58362967},
                                           {-1285736.1999577705, 8056520.944281283, -2298487.7990609105},
                                           {-2785643.103193179, 10177985.626779366, 4348139.39277931},
                                           {6235134.725553379, 6586145.305541251, -4679846.0241269935},
                                           {39493.8071966257, -10554787.456851713, -6178311.978808315},
                                           {-9994167.93439259, 4587155.628482018, -2415280.009908021},
                                           {5390807.6109587625, 5455222.072142743, 1813475.284767905},
                                           {-6840867.469311459, -1583982.699067635, 1278662.9383278962},
                                           {-6287599.150949422, 462173.77017556014, -1287078.7012370897},
                                           {-5300494.757370819, -174930.23573975306, -4366248.6393169435},
                                           {-1514741.9566977464, -6309286.508437827, 5787287.489704873},
                                           {11142543.175540786, 4949656.8575704135, 1430433.384055022},
                                           {-8289294.599852492, 420043.97656296345, 1583160.2161935528},
                                           {5539410.236015197, 1861807.827601657, 3007418.8537135255},
                                           {9515205.9518749, -1440212.4713694123, -6796917.19811607},
                                           {-2143829.724010735, -3373412.633806375, 8354786.343106353},
                                           {3862930.7355444226, 6942226.379354016, 5695876.040684725},
                                           {7378609.301718174, -4082821.696799916, 6178988.09923535},
                                           {2765448.5157208904, 5426568.243957055, 3477394.42904379},
                                           {-4780347.658382519, 6195771.112930207, -5719848.99866832},
                                           {7484606.847479125, 2301947.3635365632, 2496414.532043627},
                                           {-4704448.2275292585, 4930635.720522887, -4072839.0352421748},
                                           {-762103.2716523585, -6494544.623876597, 382199.5118667867},
                                           {4249301.839454098, 4085376.856888605, 7402764.145992559},
                                           {1122564.197333685, -6557316.524663652, 450982.5046656625},
                                           {-3092702.222986548, 1525179.4759877932, -6015487.397316874},
                                           {2868011.3603760926, -8406425.029934242, 4982229.16928815},
                                           {1499030.794647182, 2893636.7449850845, 9858895.48769888},
                                           {8032481.22101152, -5656885.701193875, 6675820.310446566},
                                           {-1643117.7118084799, -11422826.246075671, 4022930.642934821},
                                           {4812527.426674747, 1504431.9596796215, -8082692.840783419},
                                           {-10412997.962748153, 1365454.272990744, -4994640.79150742},
                                           {2997850.234012195, 1309179.261465834, -6772241.892576256},
                                           {-1662899.1678224886, -9513778.147721555, -1796256.5262107893},
                                           {-7719404.565951769, 8951165.626883138, 3355667.7316438295},
                                           {787787.799597394, -5151000.427284332, 4353216.453215193},
                                           {8194619.57437583, -7453302.475162999, -2742351.9672470284},
                                           {3194854.3415178964, 6405468.22220571, -1890193.7647708484},
                                           {1956781.2482385973, -4908406.348244281, -4040644.7684735153},
                                           {-3249788.5978862643, 2837514.4635165134, -8798021.906803537},
                                           {-8158007.909576545, 7443858.0763954185, 4551858.833020123},
                                           {-4770796.060534398, -6956271.990819118, -1072304.6914601312},
                                           {7637804.996659118, -1252702.2150212508, 1202013.9369064271},
                                           {-3155404.9018573146, -6987027.235269191, 3362923.1695913062},
                                           {1386634.819720955, 7542806.998810627, -1564330.7476016646},
                                           {6918593.32936046, 19000.56339701533, 6775899.007502118},
                                           {5392564.111952876, 4541243.398578912, -272626.44627550605},
                                           {-2076098.760054375, 7198480.115490925, 589141.1101045706},
                                           {7984143.812469775, 3691720.56448432, 7162431.826503308},
                                           {6522497.04129929, 2886378.6232994767, -3123377.1428755405},
                                           {8917275.003099976, -3125720.286457258, 4944526.847343734},
                                           {4757213.646419797, 6694424.505883773, -4223009.055737365},
                                           {-3038805.183233553, 5218544.520858286, 3701646.432362658},
                                           {8277185.355647654, -1805056.8613880808, 1964337.9869743022},
                                           {-3104957.403821076, -667404.4941869545, 7086430.007438842},
                                           {-3975525.8494175416, -10557787.906874875, -591170.1736559941},
                                           {-2522273.2939214716, 10477978.709932664, 5500010.353165535},
                                           {-2658870.55147037, -4565032.463864684, -9380442.128292205},
                                           {4473824.6453616, 7358216.444507367, 4118794.176442737},
                                           {-7119682.983774323, 10323595.832911395, 1037320.6090264315},
                                           {5341248.05786183, -3551379.5835887445, -4097335.4746796815},
                                           {-704582.2281302684, -5453866.976582263, 4157429.0460553663},
                                           {-5982084.553723772, 1447177.41073408, -4686612.571755695},
                                           {-9153261.08566838, 2479977.1825408735, 82276.17752473544},
                                           {-515588.20343626465, -10634201.162586143, 3216276.613272189},
                                           {-3185553.1261669197, 2380779.5402264134, -5749651.547164414},
                                           {-11188057.68777809, 5051543.627752415, 1657239.5668830639},
                                           {-5539256.062829268, -2509893.3988824757, -7374588.714336249},
                                           {-6074637.149989807, -2394043.789940865, 9493806.22809671},
                                           {-8760219.569913726, 2223571.400637611, -5977017.425471804},
                                           {-5447940.463732628, -4198280.028018874, 1030325.0443716553},
                                           {3297628.0779881272, 4530741.383792061, 10210302.500679176},
                                           {-590969.9906303935, -8464829.096801791, -928841.4821603844},
                                           {1080255.9094725435, 1764168.0665908684, -9644714.978374487},
                                           {3619582.8361758427, -9383363.676731298, -2451370.479722932},
                                           {-7567183.540456698, -3719208.6388707953, 1607283.502383614},
                                           {7330745.184339592, -3127555.722823629, 659539.1930066631},
                                           {-2957399.6398639036, 1690415.31208257, 8324298.496647673},
                                           {-3517401.358242638, -5419073.687834212, -8959856.417116335},
                                           {6014825.677313642, 2991756.8955350136, -8124382.409133515},
                                           {-3039486.6575260414, 8711126.398144156, -2273067.7791521735},
                                           {6016525.399691247, 9778231.325429652, -1477870.2886880233},
                                           {-2887545.571322361, -5136241.68820868, 4813271.275167384},
                                           {6621377.499138949, 6304154.287872214, -7853566.940894621},
                                           {-2664093.9336782275, 25293.92498173794, -8497331.586083373},
                                           {-100183.95621277104, 5966435.047936022, 2615571.8040822414},
                                           {4804684.045562696, 8464961.630973708, -1049881.8840687592},
                                           {1441795.796072035, -3429067.378261188, -8626258.690699402},
                                           {160769.24484018818, 4139883.755463426, 6979056.768981197},
                                           {3573204.224203911, 1960654.2252415582, -8900672.489918012},
                                           {-8449236.168732101, 6775933.413701929, -491344.6105193531},
                                           {2897266.9411220704, 11499100.302552022, -3432882.647653989},
                                           {-617534.6200209209, -2684831.624502765, 6002971.35398704},
                                           {-7316962.395308215, -6759342.619742932, -1573661.590355097},
                                           {9690605.54534051, -3220126.332536649, -7247778.05815641},
                                           {3539564.31258353, -4786377.30345536, 6193300.112361497},
                                           {-4208256.156163093, 11439258.939598424, 534537.5376649684},
                                           {4007648.713030643, -4784024.686339311, -5805341.275085689},
                                           {-142727.8528540296, 7597956.214939817, -8066895.0073513},
                                           {5331804.279998832, -7013626.3737208145, 1805606.624498386},
                                           {3053392.4086698554, 3936478.271063686, -9165843.0584951},
                                           {9132392.407027766, -4394062.318943799, -3275901.2191629387},
                                           {-6247794.920891763, -2677930.315781946, 2654591.3762705047},
                                           {-6564991.003402222, 1797737.9964201637, 3255794.060367278},
                                           {-7515496.008140789, 5250565.13527167, 3054334.0904254136},
                                           {-3688343.818028734, 3575504.076738705, -5317757.888444595},
                                           {1763369.7452779019, 2674635.1168045537, -11218157.602992078},
                                           {-6800097.553519449, -7352131.503168324, 3109457.086757169},
                                           {-4126719.8734919075, 5261504.185470566, -1660291.2458727562},
                                           {8649748.252915217, -8078259.3695404725, 1226254.8470049796},
                                           {5460287.766771574, 5369562.192280756, -8552910.065629762},
                                           {-8093419.167823669, 1650554.4947663841, -8512951.560140545},
                                           {-4093719.1128269606, -2433357.5583611345, -4300596.435516173},
                                           {-834021.7451634557, -6275951.46101536, 2969391.2498112274},
                                           {-3332628.9106099023, -4918384.057213033, -4321566.216530585},
                                           {-5071613.502778854, 2522913.6404754235, -3994444.0829146276},
                                           {-940618.1266455412, -8072876.7010429865, 6660768.711076009},
                                           {-3010337.3794790655, -11722843.060544202, -3170019.3521567862},
                                           {-6364807.78071012, 5859342.881456873, 6830357.006085409},
                                           {-6092936.930597553, 2960509.339841434, 22801.608524763833},
                                           {-7300455.8269627895, 9472348.102112679, 1849759.029531904},
                                           {1412601.3978352896, -8084110.299319579, -2444054.851129193},
                                           {5807208.747379168, 7293569.149861257, -559856.0879441915},
                                           {4302129.668943677, -9853444.805801038, -2113856.6024769614},
                                           {-8585500.74495492, -5307687.597147502, 900287.7757330892},
                                           {-5104355.776929624, 5357725.34381947, 9357973.618665483},
                                           {6929947.476094059, -2623001.5240080254, 1828533.5467130786},
                                           {7451383.076769734, -2022789.2153051712, 1265344.3017713937},
                                           {6862358.7387652695, -1371501.2124355303, 1877899.7709168396},
                                           {1652823.1385564075, 1215213.7316751052, -7725430.693282907},
                                           {-8135536.884885377, 483035.450830652, -5214399.202386961},
                                           {6145106.453065434, -3336084.9286481873, -1213114.7979456387},
                                           {3628153.874393361, 202331.32054216473, 11420706.890372662},
                                           {-3122267.6290805014, 9617247.174996624, 5579680.569309383},
                                           {-6186752.470481709, 1608979.6460778462, 9270157.583684947},
                                           {-2173482.1608806946, 12206680.430698853, 1422009.358306394},
                                           {-6045623.4350509085, -2915587.8595834235, 7354452.648572788},
                                           {-10493272.103215542, -2429341.1957647516, -750362.8539004611},
                                           {2653092.35134872, -3951462.2529645516, 6647045.043023825},
                                           {142774.47411409536, 2166606.0992887435, 12034164.756405167},
                                           {424765.3970059318, -11116040.701337956, 3887755.850538587},
                                           {-10457380.742123704, 426670.0301668814, -395719.51138827513},
                                           {6734433.596473076, -1493273.9371855606, 3211969.22607359},
                                           {2735973.5952616734, -3380564.597109299, 9099579.162233109},
                                           {8592616.859129764, 1116336.6855659517, -631040.2592761489},
                                           {-5718978.963757135, 4179227.707466334, 2913196.083783023},
                                           {-127125.80254813994, 4005361.9843057855, -8535431.51141961},
                                           {-10206784.49976174, 768084.3875707808, 1700295.8135835314},
                                           {11002478.013382096, -261993.2993182117, -4690805.792572036},
                                           {-6563917.194154789, -3567750.7524322304, 4697979.985501352},
                                           {6300480.343073627, 2917593.473349894, -3176151.5259938235},
                                           {-134474.50886158308, -8150776.721396291, 1691984.83533524},
                                           {3049743.938037898, 9557942.82416765, -34680.21703604926},
                                           {-1030870.6707754503, 245749.29263302893, 10330994.905551251},
                                           {-3742081.593296546, -4295515.921635659, 6322555.324777521},
                                           {5674396.158522104, -3462802.080583094, -9677002.96352837},
                                           {-2773164.2032188075, 4293004.86488389, 7501869.564680078},
                                           {-4282222.47447354, -7245331.034419998, 5297453.049379012},
                                           {7059071.713961745, 1592899.474113971, -8937313.311374737},
                                           {9649479.683637284, 3991666.469849081, 5949020.052009648},
                                           {-4545824.6808715, 2301302.9988021934, 7888906.168491946},
                                           {-5096858.168103788, -3226350.896856935, -2629701.164963311},
                                           {-2316244.092443144, 10883246.472824574, 1245378.907484328},
                                           {-245683.61461334644, -5324177.138938915, -5145437.871794412},
                                           {-4192493.495748537, 8782550.154604888, -2649023.747697511},
                                           {-1530253.29354867, 11986092.70752082, -172164.44496933086},
                                           {-3388562.2069334527, -9585044.928460881, -1388834.9780806564}};

constexpr double test_accelerations[500][3]
    = {{-8.9405698121846533e-01, -6.2357955314215241e+00, -2.8986663388002842e+00},
       {3.0929438073482385e-01, -6.9361389839164433e-01, -2.3738312242452611e+00},
       {-1.8742970979941718e+00, 6.1111241673509076e+00, 6.9405473322052966e+00},
       {1.8625707903021866e+00, 3.7278129085249732e+00, 5.7137995530386769e+00},
       {3.3626998520050404e+00, -2.7426153669338125e+00, -3.8553481177460722e+00},
       {2.7943140150023091e+00, -4.8766969586044713e+00, 2.8183753111532615e+00},
       {4.1294469251340482e+00, 2.9337886249163518e+00, -7.0781845778439516e+00},
       {-1.9091030087780660e+00, -4.5470368204990432e+00, -7.1474847830524657e-01},
       {2.9143945316389477e+00, 5.5258032225888645e+00, -1.3008571753889620e+00},
       {-7.0245413471944751e-01, 2.6898411289379137e-01, 5.4539831611945981e+00},
       {-8.7567660838294162e-02, -7.9264853413533780e+00, -1.0646334119364860e+00},
       {-1.7939845971360819e+00, 5.9688057279924056e-01, -2.0882803821099705e+00},
       {2.3879916443287122e-01, 4.1705383441141852e-01, -3.0307423490944498e+00},
       {-7.6210559068792953e+00, -5.2425503562176505e+00, 2.2818361254426565e+00},
       {6.4155977854339543e+00, -2.4548099460120754e+00, 6.1199110333946773e+00},
       {-1.5718242387919386e+00, 1.3600077704178790e+00, -2.8499630643518818e+00},
       {1.9405765671527593e+00, 5.6625386452440836e+00, 1.0424756863299351e+00},
       {2.4557571314122817e+00, -4.7115248329816968e+00, 5.1033893028533239e-01},
       {4.4732125885753843e-01, 4.4145440346161129e+00, 2.7454600861881678e-01},
       {-4.8113687914708247e-01, -2.5338665647585348e+00, -2.4600620602174034e-01},
       {-3.2353533457238393e+00, -1.8210643900470618e+00, 6.8524406616197551e+00},
       {-6.9429861004795401e-01, -1.0924980075302420e+00, 5.1343712182900632e+00},
       {1.4298920372806561e+00, -2.2500446567908714e+00, -1.6863445379834652e+00},
       {3.6541179153827481e+00, -8.1212537826448172e-01, -1.0311922107777312e+00},
       {5.2899695061290908e-01, -5.1093567329267691e+00, 1.1145048783358382e+00},
       {-1.6404344867087681e+00, 3.7406597591373698e+00, -1.3292852349355715e+00},
       {-2.8846913058426567e+00, -7.7512495112863746e+00, -3.9013810982427257e+00},
       {-3.3623834579607395e+00, -3.5567574969119033e+00, 2.2543796791583119e+00},
       {-2.7974103074891232e+00, -1.8166268779146366e+00, 7.3889455495919121e-01},
       {6.6509303820318859e+00, 4.7414373604864073e+00, 4.7963928458195397e+00},
       {-1.8669761652569137e+00, 2.4149750424890661e+00, 3.2063065860146502e+00},
       {5.6186794420454573e+00, 4.1703851752125276e+00, -1.3100882312371456e+00},
       {-5.5504616098857191e+00, 2.5276947306313464e+00, -3.3023589370448119e+00},
       {8.9191951142544790e-01, 5.5815992424884966e+00, -1.2510690712634398e+00},
       {-3.7037203800811236e+00, 4.4455418035853267e+00, 3.2525446070521262e+00},
       {-6.8587511103660441e+00, 3.2625011371878778e+00, -2.2454020006155844e+00},
       {5.6056108135591822e+00, 1.6740148847521903e+00, 1.0596151552561301e+00},
       {-2.8934358262213347e+00, 1.1948245212398669e+00, 3.3697356742867868e-01},
       {8.8429086748172903e-01, -2.7853786659081198e-02, 3.8022005271316490e+00},
       {3.8471757594272737e-01, -2.5564771903579220e+00, -1.7404965017686684e+00},
       {1.6785135816175276e+00, -5.2471514325896174e-01, -2.3055283474549615e+00},
       {1.5395534891227032e+00, 2.6046980987356196e+00, 1.3888535988787938e+00},
       {3.1612232468984445e+00, -5.6749556398158028e+00, 1.8717206243654194e+00},
       {-4.2161975221814263e+00, 2.9256232705827645e+00, 8.7502585916748102e-02},
       {2.5299857774911749e-01, -5.6893920509899205e+00, 1.1915592582949079e+00},
       {1.6512570518287515e+00, -2.6082091681692940e+00, 8.3612440853603409e-01},
       {1.8133845513869232e-01, -3.2567939897671496e+00, -1.8453151613627279e+00},
       {2.1590012667774214e+00, -2.7673329894103511e+00, -1.1341354108962987e+00},
       {-2.6181014201305222e+00, -8.2645390705319538e-02, 1.0061921723671381e+00},
       {4.2589948053009508e+00, 4.4564738450893220e+00, -1.7263425752218380e+00},
       {1.1408265246634597e+00, -5.5297601634642106e+00, -2.2324291703474333e+00},
       {-3.2308837359671467e+00, -1.4732007532204705e+00, 4.2918785458922443e-01},
       {1.8678434685731569e+00, 1.6852719094999051e+00, 1.3721678564124251e+00},
       {-2.9362521581017771e+00, -5.8837771069949127e+00, -6.9600743285143052e+00},
       {1.3549348630786770e-01, -3.8091643205123349e-01, 2.6468363781474440e+00},
       {5.1071615654091058e+00, -1.9891856536307806e+00, -2.6804251452765371e+00},
       {-2.5752579925556676e+00, -3.5541229904464693e+00, -3.4559425148106966e+00},
       {-5.9352615304242040e-01, -2.9054735605260023e+00, 2.1035413982630171e+00},
       {2.6098749000918082e+00, -4.2457593708416530e-01, -3.7420875211155780e-01},
       {2.2503627754731115e+00, -3.3660705231365873e-01, -8.2947003384182523e+00},
       {1.3714702627479730e-01, -4.1704346242287382e+00, 1.8066575523753376e+00},
       {8.5630690460258230e-01, -2.7794746702362847e+00, -6.8918273432218879e-01},
       {7.8346264035314728e-01, -4.2421933218190500e+00, 7.5689827995461301e-01},
       {2.5214043774429767e-01, -3.7879858388534005e+00, 4.5152791109582552e-01},
       {2.8574491287026937e+00, -3.1070465067321024e-01, -1.6854737392799435e+00},
       {-8.7173767057518015e-01, -3.5793869731697958e+00, -3.3444931937656691e-01},
       {8.5253147318413980e+00, -2.3402641326415299e-01, 4.2525882701655116e+00},
       {-5.6473915194690562e-02, -2.4033880338775577e+00, -1.3267122172486461e+00},
       {-3.3161038709778001e+00, 5.3371183548226035e+00, -7.5151599225932175e-01},
       {-1.8857947973976661e+00, -4.0161162654430056e+00, 1.8489262115302654e+00},
       {-1.8314994009355994e+00, 2.1538213252559437e+00, -5.6004521922227579e-01},
       {-2.0469114312351939e+00, -4.2320223746446448e+00, -2.6080795829994079e+00},
       {-7.7175746964455475e-03, 2.3172899276243633e+00, 4.1340133395962502e+00},
       {2.1595100180029565e+00, 1.8122649215425595e+00, 2.5415603443007053e+00},
       {-1.3040046741924425e+00, -4.9691517239766423e+00, 1.5871603130406113e+00},
       {-3.2154502883118097e-01, 5.1774176683323949e+00, 3.0129580344470495e+00},
       {-1.9534575114317030e-02, -4.1984464048758952e+00, -5.6314927972138085e-01},
       {-2.6070785208328067e+00, -1.5544721069710672e+00, 6.3509798048172854e+00},
       {2.0356451194486889e+00, 1.8653752259566425e+00, -4.2007162703011325e+00},
       {5.7171798927890505e+00, 1.3524121656878980e+00, -3.1424944957661256e+00},
       {5.0890436816367082e+00, 5.7379468179681785e+00, 1.2530835311916189e+00},
       {-8.2814085622546785e-01, -1.6096481846151314e+00, 1.7569760302878679e+00},
       {-1.6450478075266006e-02, -1.4269133043905591e+00, 2.5757002448081368e+00},
       {8.9307247205395401e-01, 2.0574891395582298e+00, -1.2229739969858253e+00},
       {-4.2264727406181581e+00, -2.3537910524760863e+00, -6.5027253294223786e-01},
       {-4.3029557300485264e+00, 4.2989839700230199e+00, 1.0507002343904421e+00},
       {2.2710119443708394e+00, -1.0915029843518012e+00, 1.0112247797999374e+00},
       {2.0647957699458788e+00, 1.9001088859479196e+00, 5.5382689170273478e+00},
       {1.5856276042390443e+00, -3.7873433316332896e+00, -2.4827287472286694e+00},
       {-1.3125150921862279e+00, -2.7427273681901827e+00, 2.1583864953754754e+00},
       {-5.8946720786824978e+00, -3.6014447015579942e-01, 3.1051975257561764e+00},
       {-9.3196649664345477e-01, -3.6339005306494547e+00, 2.3743700410535387e+00},
       {-2.0734929642835471e+00, 2.2080368641283621e+00, -4.0609519824470841e-01},
       {-3.4253331221294645e+00, 5.9051014623117659e-01, 1.6072241437916366e+00},
       {3.1980211004666166e+00, -1.2247129825617804e+00, 4.3119358109695725e+00},
       {3.6083564905248098e+00, -3.4422787494978708e+00, -5.5917521957340472e+00},
       {5.7417368854786599e-01, -3.4905803438709624e+00, 3.0579056314880728e+00},
       {-3.6671741073288269e+00, 7.9304978166810680e-01, 2.5933903232392299e+00},
       {-4.9166109429926550e+00, -1.8827179315748008e+00, -2.8931815346101435e+00},
       {4.2550348767154560e+00, -2.7480547799044124e+00, 4.1564401932994022e-01},
       {-1.2411878602028976e+00, -2.2124229923563941e+00, -4.4726878610554488e+00},
       {-3.0131553389569149e-01, -4.8596754602397958e+00, -6.2789891617288722e+00},
       {-5.0260398888080415e-01, 2.6340473910178952e+00, -3.2897397280086849e-01},
       {-6.4343369308325904e-01, -2.1523855439867390e+00, 2.0418108085121327e+00},
       {3.3238967022359227e+00, 1.1275720799566578e+00, 1.4633009821759850e+00},
       {3.9380165687106383e+00, -4.3556069592734223e+00, -2.0391062592386886e+00},
       {3.6996933540342463e+00, 1.6940270723775858e-01, 1.6453949672320900e+00},
       {2.6286048091247411e+00, -4.5460940299997405e+00, -1.3517239888714408e-01},
       {8.9074319010204728e-01, -4.2710160352975048e+00, 5.0414288377217158e+00},
       {1.1796478153732630e+00, -5.8200314232112014e+00, -7.3281211982964800e-01},
       {-1.5810551461616495e+00, -9.4017834010739454e-01, -3.4756421075170989e+00},
       {5.5922752502256019e+00, -6.4178699767058245e-01, -1.4246117967470457e+00},
       {-2.4520909945239713e+00, 2.2076100151365758e+00, 1.5548609867715975e+00},
       {-1.7129371268179594e+00, 5.8974843572713120e-01, 2.1780184090888541e+00},
       {-3.1309572889957642e+00, -5.4409010462938812e-01, -6.3649144394103074e-01},
       {-2.3858978672400406e+00, 1.3558920226932301e+00, -2.8487245201268402e-01},
       {-1.7167411640885784e+00, -1.6433710786893720e+00, -1.4123243705817319e+00},
       {3.7192704928519275e-03, 2.7431001587934217e-01, 3.1746390297334965e+00},
       {-2.5324745439655496e+00, 1.9259243215086559e+00, 3.0882230651007712e+00},
       {-3.1710447480433643e+00, -5.5946401854440824e+00, -1.5231957326804588e+00},
       {4.2717347131513819e+00, -7.6042044281089032e+00, -1.3183558224250453e+00},
       {3.3712918955496551e+00, -3.2401680049428649e+00, -2.0749256297409429e+00},
       {2.7553849223694256e+00, -3.9550276590295406e+00, -6.1829800712961971e+00},
       {6.5936164001751258e+00, 6.7581985263932065e-01, -4.2199534934615430e+00},
       {-5.6685782347021183e+00, -3.2069500134991913e-01, -1.2908586339652885e+00},
       {7.3274268812087173e-01, -3.8691915521899706e-01, -5.3716005396236577e+00},
       {-1.7041980972792075e+00, 1.6482142797226333e+00, 8.1959937094789492e-01},
       {-5.4900701957209783e+00, -3.3598604211217937e+00, 3.9102506713552621e+00},
       {3.2841668399738513e+00, -3.2950179875370467e-01, 1.7255047450490726e+00},
       {8.8632329327322861e+00, -1.0502173150768916e+00, -2.3762649175094257e+00},
       {-3.7961673072904528e-01, 1.8289847973782283e+00, 2.1931136853510025e+00},
       {-7.6419596921176058e+00, 1.7304379802991334e+00, 1.4722840753267614e+00},
       {1.2862854590565509e+00, 4.6554296402699826e+00, 1.5851290011711028e+00},
       {4.2351652873188889e-01, -2.8185065013135215e+00, 3.3534450732589467e+00},
       {1.1050643494001957e+00, 2.0135035223835378e+00, -2.0094431832702222e+00},
       {1.9167171656232600e+00, -2.7259928898707941e+00, -2.9938978029051766e+00},
       {-5.9361476240416722e-01, 5.1893561485015880e+00, 2.9992167842329618e+00},
       {7.7663821168484815e-01, 1.5426711035834795e+00, 2.4928492108252835e+00},
       {-6.5143096798483260e+00, 9.2578887421291745e-01, -1.7351217197994502e+00},
       {-1.3678931590495875e+00, 1.5183750526784565e+00, 1.5024431373358698e+00},
       {-3.4102368972424153e+00, -1.0165763783459871e+00, -6.0352077239311541e-01},
       {2.2851802704592323e+00, -8.8266031499347317e+00, 2.0493365755966932e+00},
       {-1.1471559519525516e+00, 1.3450229843458292e+00, -1.8429451652180218e+00},
       {2.1075716571418592e+00, 1.5484681447221673e+00, 1.0638314860469760e+00},
       {3.7826347565308978e+00, -5.6223153121812324e+00, -2.6892859481623954e-01},
       {-1.2867685731703502e+00, -4.6877701829495649e-01, 2.0868848230199939e+00},
       {-3.7790954922011072e-01, 4.6623619877168618e+00, 1.3195733678793564e+00},
       {-1.4820416913292236e+00, -1.4145565707240355e-02, -2.0181834296434862e+00},
       {-2.5069519110273775e+00, -1.6545231178894666e+00, 3.0264063061730910e+00},
       {-4.2690950960064775e+00, 1.7433247440559899e-01, -2.5088063194853869e+00},
       {-8.4509408829203825e-01, 5.1244545277356162e+00, 5.1903204556775706e-01},
       {-2.1648823331620779e+00, 2.3561582096996063e+00, -4.1557235089748279e-01},
       {1.9003695874199762e+00, -2.7462323827603297e-01, -2.4686164662532271e+00},
       {-8.6158846099531550e-01, -1.5407356719973224e+00, -2.3766724804336694e+00},
       {3.0298087452871880e+00, 6.5684042572475676e-01, 4.0152479656980256e-01},
       {1.0397214274566389e+00, -5.2294384988497000e-01, -7.3373760595267514e+00},
       {-4.1530044889806854e+00, -6.8280160113250350e+00, 3.8294857055680191e+00},
       {-2.4276193908149519e+00, -4.1570803609379432e+00, 3.2120469603729935e+00},
       {2.7561515693822264e-01, -5.3786909953464033e+00, -1.2894245263874369e+00},
       {-4.6901060251081539e+00, 1.7523721420309750e+00, -9.2206217424183279e-01},
       {-3.9638858988144143e+00, 3.2933906002296148e-01, -1.6491169624255717e-01},
       {1.5997304209386667e+00, 5.3388856503406315e+00, 2.3358217444250688e+00},
       {4.1775232900506748e-01, 2.4533947746084217e+00, 3.3491070797710021e-01},
       {5.6463616961050445e-01, 5.1136418320979375e+00, -4.8082072823032646e-01},
       {2.1107418302157193e+00, 2.3162587592503206e-01, 6.2624745622596389e+00},
       {-1.0831786340544558e+00, -2.2085037722296694e+00, 4.3491281433812450e+00},
       {-1.2908772494570471e+00, 1.2486699800299657e+00, 4.3081844754896350e+00},
       {-2.1916583926556652e+00, 2.0480491641391816e+00, -2.7698190310013713e+00},
       {1.6974249396227590e+00, 6.5315028646268400e+00, -1.6708604917215097e+00},
       {-3.9682128095707503e+00, 1.7639241700103605e+00, 1.7508134913911462e+00},
       {-2.5548351912885141e+00, 3.2278131872992166e-01, -3.8822148424500241e-01},
       {5.0087761211621329e+00, 1.0941108217663316e-01, -5.7749979666155253e+00},
       {-8.5954764210356693e-02, 1.8060197389904364e+00, 2.4197753597592810e+00},
       {3.7390138609929084e+00, 3.3645926420010350e+00, 3.8539869008682981e+00},
       {-3.9178365588490331e+00, -3.4492249688983971e+00, 1.8928132469289982e+00},
       {1.1012647163851319e+00, -2.5021565420316989e+00, 2.2965537912449308e-01},
       {-4.0054138630927616e+00, -1.8156244115013900e+00, 1.3041101199429324e+00},
       {-1.4331890630580029e+00, 1.2338972430653998e+00, -1.8392975039664337e+00},
       {-9.4187725437578429e+00, -1.3145888724541499e+00, -8.7195723708955863e-01},
       {2.0971832992100170e+00, 5.0052085412933567e-01, 3.4420454374843348e+00},
       {-3.2824742556707669e+00, -6.7124568527509343e+00, 4.0332030429573553e+00},
       {-2.6093168965118050e+00, -3.4524538315452737e+00, -6.2389382419723763e-02},
       {-1.3695008978567011e+00, -2.3440206842803479e+00, -1.6454504751767434e+00},
       {-5.1926146135435998e+00, 5.0667833598863892e+00, -1.9378256782929315e+00},
       {8.0952735361710981e-01, -2.8138207757998242e-02, -6.5082045410232645e+00},
       {1.4619845229139696e+00, -2.2751845327760800e+00, 1.0279648209093091e+00},
       {-3.1018859095949081e+00, 1.5397868631741618e-02, -7.6709907919507214e-01},
       {1.5023216823094057e+00, 4.4646883031089485e-01, -3.6442866017514208e+00},
       {1.2699936337377926e+00, -3.6471854773154964e+00, 4.0758248123881469e-01},
       {3.4558013911906711e+00, -3.6500496949062584e+00, 4.6451498249189118e+00},
       {1.1962839522360520e+00, 3.3804509100952576e+00, 2.3065777776345833e+00},
       {-1.9415885637819672e+00, -1.8289539683115386e+00, 5.2900151952130003e-01},
       {-1.6263330016501279e-01, 3.1459269014242266e+00, 3.5836533303211011e+00},
       {-6.3644258580210060e+00, 5.6992964195752833e+00, 4.2627163017757408e-01},
       {8.7521462104036674e-01, -1.3788015048376487e-01, -2.4440449817729886e+00},
       {1.8635342455955699e+00, -7.7458035571293948e-01, -2.3363691622594129e+00},
       {-5.1902331677622850e+00, -6.5302604652805938e+00, -1.6404660027413540e+00},
       {2.0878089817183945e+00, -1.1013765857021269e+00, -4.2517722440915540e+00},
       {-6.4531991900996200e-01, 7.1069854691677925e+00, -1.9036403287069845e+00},
       {1.2878655835678710e+00, -7.7278866626501908e-01, 2.3144304660321851e+00},
       {2.4834150081611801e+00, 2.3300698127977215e+00, -1.1077454197088172e+00},
       {-2.4933812135354265e+00, -7.0371147285628066e-01, -4.6564401807055816e-01},
       {-8.2081597687610641e-01, -4.2628595874586557e+00, -1.3230774363917555e+00},
       {-6.2029534167980993e-01, -2.0778792423832542e+00, 1.1912153521267534e+00},
       {-7.4355301064880530e+00, 8.8365374088498905e-01, -3.9491079771449833e+00},
       {-6.1878854661454561e+00, -1.7788305561520523e+00, -4.3566821977141418e-01},
       {-2.3102711590633226e-01, -1.0433811391660706e+00, -2.7974652623748635e+00},
       {-2.5378390702249307e+00, -5.0727992709333547e-01, 2.8777067859563457e+00},
       {1.6974578141704879e+00, 2.0397237038224589e+00, -1.3556576088678834e-01},
       {2.1005827956015479e+00, 3.0157674937558920e+00, -3.6671951397529980e+00},
       {4.1026152537807574e+00, -5.9945862694814052e+00, 6.5003472221635850e+00},
       {-3.7136163483979012e+00, -8.6335894077773279e-01, -2.4747858554845816e+00},
       {3.4213585905806934e+00, -1.4802797456887795e+00, -6.5673559307241938e+00},
       {-3.0505271044979940e+00, -5.6604840927323954e+00, -3.4877053956503641e+00},
       {5.6683383569381114e+00, -2.8111881545275645e+00, -2.0421556573240687e+00},
       {3.8894434950541061e+00, -3.9980635211240902e+00, 3.8512592801767123e+00},
       {-4.5082638235709060e-01, -2.4542754586762325e+00, -4.1507859998962662e+00},
       {-1.1968052321897567e+00, 1.8435860571934390e+00, 3.3441144249387511e+00},
       {9.9834775614739113e-01, 2.6478353200021609e+00, 7.8960459657907289e-01},
       {4.1598953051466214e+00, -7.7599602552163094e-01, 8.2196676535604958e+00},
       {7.0146761840905842e+00, -5.1176831164400021e+00, 5.7245161845031600e-01},
       {-3.6963298118052523e+00, -3.0205571901769330e+00, -2.5721612684435216e+00},
       {3.8741455413373402e+00, 2.9293694672494377e+00, -1.8348260624800720e-02},
       {6.8713864543055916e+00, 1.7937641654042571e-01, 4.3309482125272476e+00},
       {-2.5050435441077812e+00, 1.6936843004171920e+00, -8.2119505563626205e-01},
       {-5.3675031873083725e+00, 1.0620657878434729e+00, -2.9746419026106330e+00},
       {-7.8923593141995241e-01, 2.0082934443885954e+00, 1.2227801236366558e+00},
       {-2.2549663116548291e+00, 2.5034598666556471e+00, 1.2337628306265602e+00},
       {6.9478594438292971e+00, -1.8378321866471126e-01, 5.0580077663276484e+00},
       {1.8828611639990567e+00, -1.9119093277670762e+00, 2.5173357233698107e-01},
       {2.1652079629846961e+00, -2.8749387208103011e-01, 4.0997083160252252e+00},
       {2.9150520572485958e+00, 5.7970797264620566e-01, 5.0232693277021589e-01},
       {-7.5713684176464957e-01, 1.6713743072991880e+00, 2.7441009226841593e+00},
       {-3.0185638594302393e+00, -4.2104737287722678e+00, 2.8315176171945180e+00},
       {6.6460264594116758e-01, 4.8643871888242163e-01, -4.3071459154227254e+00},
       {-3.7366964450617806e+00, 2.5056277643852054e+00, 7.6497631076341159e+00},
       {-1.4234820894166293e+00, -8.1460396697112749e+00, 3.7261918176668720e+00},
       {1.2542379590626056e+00, -5.1724940497633316e+00, 1.3131471451613479e+00},
       {-1.0940393347574002e+00, 1.6720583776149072e+00, -1.7625218588243639e+00},
       {1.1927510914979851e+00, 1.6828636834114918e+00, 2.5156602188414445e+00},
       {-1.5883146739367731e+00, 3.5016371817671627e-01, -2.6913756205239729e+00},
       {2.7246666639147827e+00, 3.3827898622425643e+00, -2.1529784454325691e+00},
       {-1.4651794188940523e+00, 4.8286804346716955e-01, -2.0389183040453318e+00},
       {-1.4248913461902646e+00, 2.7180455180397303e+00, -2.5546184476850606e+00},
       {1.7080054109452754e+00, 3.3349349720011157e+00, -6.6840391778445207e-01},
       {-4.4987888749310889e-01, -1.1360247374147094e+00, 2.4393984348301596e+00},
       {-8.6038629157505131e-01, -3.6892543937500037e+00, -5.1880350715651371e+00},
       {-4.2234574836606358e+00, 4.9118863557314478e+00, -1.0972908675923179e+00},
       {1.5431230939775298e+00, -2.6500264432884912e+00, 2.7054633624958475e+00},
       {6.7535178768069171e-01, 1.6001003928183706e+00, -3.7193191991700187e+00},
       {2.4951391894957196e+00, -1.0727606505574843e+00, 2.4691322765150483e+00},
       {6.1917246326065305e+00, -1.6168477243230714e+00, 4.9262667836316716e+00},
       {-5.8279801693876054e+00, -3.8782834258207366e-01, -1.2618518060350252e+00},
       {-2.3917593782731510e+00, 4.8960655670979421e+00, -2.9516652534903924e+00},
       {1.1260328926789036e+00, -2.7700532309491432e+00, 3.2550464431472923e+00},
       {1.9760323783486251e+00, -3.2413753896222111e+00, 8.2400791411440044e-01},
       {-4.2877400948595117e+00, -2.0706496373899723e+00, 4.9198897201890762e-01},
       {1.9434523727294830e+00, 1.9343732841426835e+00, 2.3302105552751226e-01},
       {-8.7931761628936822e-01, 4.8384292886408709e+00, 2.0666339000750597e-01},
       {4.1246251738383730e+00, 2.8661989674676785e-01, 4.0024072467327687e-01},
       {2.0123672588176040e+00, -2.8366433303499250e-01, 7.4976339304471766e+00},
       {-2.9683747290850593e-01, 2.1233800628002824e+00, -3.7801567793592534e+00},
       {-2.0866565870942364e+00, -1.4513711276827155e+00, -3.9889772406946328e-01},
       {2.4107658328365451e+00, 6.3383606246526414e-01, -1.1286286637600618e+00},
       {6.3449970901883965e-02, 9.0430242556905682e+00, -3.1243481091170828e+00},
       {6.7529873072498037e-01, -7.5340938079954634e-01, -2.2747022106315335e+00},
       {-2.8613251230207646e+00, 2.8209807295053824e+00, -4.3457537781977384e-01},
       {2.7334924209915252e+00, -7.6045305275990860e-01, 8.7595499099527463e-01},
       {-4.1575621307799393e+00, -3.7073030575864414e+00, -3.2719893689606825e+00},
       {-6.5803425819389298e+00, 9.6225218785730815e-01, 5.4968547341946925e+00},
       {2.5936718427144592e+00, -7.3763508179691262e-01, -5.1841978059218352e-01},
       {-6.8039477540800905e-02, 3.8822654351615573e+00, -2.1130066141020647e+00},
       {-5.3742909362875055e+00, -2.8782346040643940e+00, -8.5530623754526136e-01},
       {-1.6232165731484482e+00, 4.1888079450237301e+00, -4.2001603443808273e+00},
       {-2.0749765953584762e+00, -2.9328090144489973e+00, 3.6615920687312840e+00},
       {-3.6112103948740448e+00, -3.6093441323411768e+00, -4.1400035757418845e+00},
       {4.8265926333878534e-01, -2.8791060035591971e+00, -5.5657774195575493e+00},
       {2.4177406105649024e+00, -1.2375028572886744e+00, -2.6615093660726878e+00},
       {2.5618670015857248e+00, -2.3752391248616112e-01, 6.3328579868223234e-01},
       {2.3434418551446470e+00, -1.1336097085399912e+00, 2.5118532549421557e+00},
       {-3.9864418762274911e+00, -8.7898743727489270e-01, -8.0329189650179444e-01},
       {5.2262371348653378e+00, 3.6501572502051003e+00, 3.4986387839753732e+00},
       {4.4736617833117903e-01, 8.8480978378152262e+00, -3.9096949014589963e+00},
       {-2.6239241406423601e+00, 3.5237379111172951e-01, 1.0511934061136960e+00},
       {2.4049359162145700e+00, 8.5152610680631191e-01, -1.2462831653498829e+00},
       {-2.4817370986112413e+00, 1.1324284110526714e+00, 6.1366303493010743e-01},
       {-6.7762139926692484e+00, 2.1095844296836184e+00, 3.4772935172661146e-01},
       {-1.2371418472535756e+00, -5.1386240494548812e+00, -7.6380377028387620e+00},
       {-4.0189881598628299e+00, -1.7807199456396108e+00, 9.1645276564205069e-01},
       {-1.0012174550105049e+00, -1.8121147585823254e+00, 4.1519052056961652e+00},
       {5.7217217437208201e-02, 1.6348907380133733e+00, -3.9545894012099851e+00},
       {1.6982524796770787e-01, -2.4601146483811709e+00, 2.2271769195601441e+00},
       {-1.9528485687290567e+00, -1.6623544752862469e+00, 1.1757845476589111e+00},
       {-3.4936397904973502e+00, 1.2979337763600001e+00, -2.3337884976010357e+00},
       {5.6884571727837556e-02, 1.2830171569044016e-01, 3.1006223709953522e+00},
       {-8.0106130473348234e+00, 2.1548192201790854e+00, -5.0130485363624606e+00},
       {3.1972374478660162e+00, -5.8586195191287445e+00, 1.0672613337477486e-01},
       {-2.1059603932354665e+00, -5.5478785271342881e+00, -2.1418675051395151e+00},
       {-3.1311822441952684e+00, -3.6331787880592863e+00, 1.6651131551163496e+00},
       {-2.4368910614180002e+00, 9.0550236452727284e-01, 1.1140438505552153e+00},
       {-1.5036397328183100e+00, -2.5125057851311152e+00, -6.4621569968988579e+00},
       {-5.7706308467324652e-01, 1.6906150177959478e+00, -2.2948011086502689e+00},
       {-1.6725773854167996e+00, -6.8125939320217785e+00, -2.0337649134932216e+00},
       {-4.5482392340093014e+00, 5.2969235340030068e+00, 2.2217164846397846e+00},
       {-2.9653821360422485e+00, -1.1029773613266740e+00, 4.2267685857606931e+00},
       {1.6403102779349068e+00, -1.5130840454889694e+00, 3.8967089617180792e+00},
       {2.0628219323931369e+00, -1.4608277882065728e+00, 1.2841053719262188e+00},
       {-3.3818119114350154e+00, 5.0860590212238344e-01, -1.8222824793689203e+00},
       {-4.1279231147153821e+00, 3.0901335690699483e+00, 2.8518143693997922e+00},
       {4.8283623989057665e+00, -4.2865402281693195e+00, 3.5769088426589666e+00},
       {3.5288202869478793e+00, -1.8068862495118392e+00, -2.1916147566111563e-01},
       {5.7269344822597512e-01, 2.5731188821757027e+00, -1.6859601044965520e+00},
       {8.0582753547189789e-01, 9.7551082628971797e-01, -4.5326362569303456e+00},
       {-1.9953724231869441e+00, 1.5649543485257880e+00, -5.9925515106599976e+00},
       {2.2007329094049775e+00, 5.2842316347212579e+00, -8.1012567756162635e-01},
       {4.4348189124557527e+00, 4.2799928580450447e-01, -1.3613610927031277e+00},
       {-2.1374730321416346e+00, 1.5389725684806512e+00, 9.3047025364044700e-01},
       {9.3176272144926831e-01, -1.6701260256989754e+00, 1.8864047619402353e+00},
       {5.2158964342978900e+00, -5.7361296117221059e+00, -2.0781748703946068e+00},
       {3.6535843366862024e+00, -4.9347833994268733e+00, 5.9149508034785736e+00},
       {3.6937649492155797e+00, -2.4375258855871682e-01, -4.6261267643988742e+00},
       {-6.7464415577177803e+00, -1.4958747977230447e+00, 6.8887886814454617e+00},
       {3.8008353311795053e+00, -1.1586514491305313e+00, -1.4191493357647336e+00},
       {4.6926528223182451e-01, -1.0548565287387739e+00, 2.2809490835242547e+00},
       {-1.2480186357869176e-01, -2.9125988341899203e+00, -1.1785837910259087e+00},
       {-7.3207986111715057e-02, -4.5294908685684305e+00, 3.4485572713944905e+00},
       {-2.6406505071577784e+00, 8.5743817898263259e+00, -2.9385083434063559e+00},
       {1.9907709338634667e+00, -1.7420136294109902e+00, -2.4530919895456078e+00},
       {-1.0200313079207506e+00, 1.2402325711306317e-01, 3.0766344538531598e+00},
       {2.2875590068831366e+00, -1.3968477624749762e+00, 8.6439415002636821e-01},
       {6.1503685989407042e-01, 1.8040337719724306e+00, 2.0914637061029642e+00},
       {9.8607405189638475e-01, -2.7189666945767170e+00, 1.5024622935051648e+00},
       {-1.7949637669925109e+00, 3.4424377743752048e+00, 1.2258094118522251e+00},
       {-3.9476862670117840e-01, -1.6707497558959341e+00, -4.8299662428304915e+00},
       {8.4203443345428974e-01, -5.2765650409681051e+00, 1.5081497180565739e+00},
       {7.4697891236476288e-01, -2.7293241697696979e+00, -1.1671784501861426e+00},
       {-2.3380176940143884e+00, -2.4696564658027604e+00, 1.7570388297481523e+00},
       {-8.6012474046661038e-03, 2.2995270541392601e+00, 1.3472317083338008e+00},
       {2.7925055276079274e+00, -1.2817133457324696e+00, 6.7557191636356373e-01},
       {-4.3933224612863135e+00, -4.4459219005527641e+00, -1.4810533191316768e+00},
       {7.5078694654224334e+00, 1.7384453847411072e+00, -1.4070200102121218e+00},
       {9.4194944079207765e+00, -6.9222280410472747e-01, 1.9340762062855710e+00},
       {6.5081205591102815e+00, 2.1484799573441080e-01, 5.3762570149755344e+00},
       {9.1765230889421701e-01, 3.8222628370186502e+00, -3.5121507098385232e+00},
       {-2.4017229466966312e+00, -1.0668841974569891e+00, -3.0859300450079408e-01},
       {5.4813134651762008e+00, -2.7772954061467170e-01, -1.0488358085275362e+00},
       {-7.7769633468734067e+00, -2.6139580170184624e+00, -4.2351457304819888e+00},
       {-2.3183648377245776e+00, 3.5090795678493703e-01, 1.6576353217203446e+00},
       {1.0730855021009473e+00, 1.6885643996417952e+00, -4.1883878071320568e+00},
       {-1.6475017307137225e+00, -2.9608369777874421e+00, -2.4326061536562800e+00},
       {-2.5729300933370625e+00, 1.4237019397646800e+00, -2.1572256072638405e+00},
       {-3.1942673024460739e+00, -6.2682729113050888e+00, -4.0274586964224977e+00},
       {2.0911193842448541e+00, -2.7103114685906800e+00, 2.5056548441577426e+00},
       {-5.3764503123287284e+00, -1.6536021965038432e+00, -1.7967525249723857e+00},
       {3.7459494267938980e+00, -3.9261364400109624e+00, 3.2499529763995891e+00},
       {1.0826021596075488e+00, 9.2250288221579755e+00, -5.4453888423074703e-01},
       {-1.9957650922010750e+00, -1.9188199902303220e+00, -3.4820068945855152e+00},
       {-1.5114204039249266e+00, 8.8292461735303469e+00, -6.0908670746296956e-01},
       {3.6838746303218564e+00, -1.8166903048419898e+00, 7.1852439525283556e+00},
       {-1.0821552385200595e+00, 3.1719279465088097e+00, -1.8822976130319407e+00},
       {-5.3256396872182377e-01, -1.0280580791050249e+00, -3.5069350139629689e+00},
       {-1.9100118889750382e+00, 1.3451401247174666e+00, -1.5889048313396665e+00},
       {3.5885786655495483e-01, 2.4947409580115951e+00, -8.7938638182241458e-01},
       {-2.2145941847330648e+00, -6.9229551742793982e-01, 3.7248690876003829e+00},
       {2.6391671368066505e+00, -3.4606907387640196e-01, 1.2671354476901036e+00},
       {-2.7988849763134525e+00, -1.2222676690779430e+00, 6.3376227836879755e+00},
       {6.9958169330767672e-01, 4.0024104001715193e+00, 7.5670783884563486e-01},
       {1.6591724344662087e+00, -1.9239343262728805e+00, -7.2189048659051547e-01},
       {-1.0015648920423739e+00, 6.5487263121377310e+00, -5.5503528582056481e+00},
       {-2.1988025747973312e+00, 1.9998952243454959e+00, 7.3658088120800302e-01},
       {-3.1408172594513064e+00, -6.2972650642171946e+00, 1.8626174560002227e+00},
       {-2.6466163291384612e+00, 6.6388021529586583e+00, 5.4815257850481727e+00},
       {1.3739065896210758e+00, -1.1996018276610634e+00, 3.7246438679899678e+00},
       {1.9081688725010559e+00, -1.7411361123716393e+00, -1.0656820136158833e+00},
       {3.0958789611273092e+00, 4.5141004280618739e+00, 6.9710471850500788e-01},
       {-6.3416105919681547e+00, 1.0401177986033261e+00, -1.0001538856241754e+00},
       {2.1440593345286745e+00, 4.7475794423609470e+00, -2.2893749205115137e+00},
       {-1.1536121201054836e+00, -6.2752490217158652e+00, 1.3041812037114795e+00},
       {-3.0335453497552582e+00, -8.3385798665109260e-03, -2.9751664585558033e+00},
       {-6.1284776526430109e+00, -5.1611186059192908e+00, 3.1066337064148869e-01},
       {1.9519057833291598e+00, -6.7684310249174526e+00, -5.5527006504877130e-01},
       {-2.1792145484277210e+00, -1.0076421587513005e+00, -1.9569435482839135e+00},
       {-5.5083250972443967e+00, -2.4376131333931723e+00, 2.6434477198000872e+00},
       {-2.9302507897517449e+00, 1.0271325463173131e+00, -1.6266745348774789e+00},
       {-2.4076956796153124e+00, -3.3881792016678496e+00, 2.1406178274927998e+00},
       {3.4068153939794463e+00, -5.8508634192576325e+00, -4.1611177837239630e+00},
       {-5.0196874719158950e+00, 1.0946852540934142e+00, -1.1933397608263352e+00},
       {2.6337436267722585e+00, 5.6612937408787356e-01, -6.0241655639153606e+00},
       {1.0996875561022805e+00, 2.9204335322983894e+00, 1.6369121694543451e-01},
       {5.6754636885889032e-01, -2.3577411697180826e+00, -1.2387213086620479e+00},
       {8.4802260529250084e-01, 1.4559662668806810e+00, 2.9952088722825012e+00},
       {-2.0501681611460554e+00, -3.3720168022302679e+00, -1.8902139923426846e+00},
       {1.4248730253285358e+00, -2.0660949013983259e+00, -2.0777604431703567e-01},
       {-4.8262233187135894e+00, 3.2089715575706097e+00, 3.7107002349695750e+00},
       {8.5617430110930726e-01, 6.6275723407238232e+00, -5.0662007144640855e+00},
       {5.1458369948739158e+00, -1.2448860746671639e+00, 4.0404940280798423e+00},
       {4.2806883496046364e+00, -1.1597908178921981e+00, -3.8544909939185031e-02},
       {1.4943279790556899e-01, 3.0820507373834483e+00, -9.3315642396281095e-01},
       {3.7041728479917091e+00, -2.7683873017271914e+00, 6.7039448516033229e+00},
       {2.3473052024319174e+00, -1.0598352816835319e+00, -3.4799949739229030e-01},
       {2.5245063752314434e+00, 1.1438862935843390e+00, 3.3658500694379829e+00},
       {1.5809368595281423e+00, 6.2306093491416259e-01, -2.4732427626701750e+00},
       {2.7438810111438956e+00, -6.9646700537037609e-01, 1.8742534574827314e+00},
       {6.4635143434418891e+00, 4.9810072457254924e+00, -1.2258147331595508e+00},
       {-8.3079708901972160e-01, -1.1414823992675731e+00, -2.5748811693206561e+00},
       {3.7906203027388474e-01, 5.4293127763528144e+00, 5.9682711090442553e-01},
       {-4.4746931820887181e-01, -7.3078876519295977e-01, 4.0006943291364472e+00},
       {-1.3012228926414509e+00, 3.3732789177037823e+00, 8.8233841174335381e-01},
       {4.7729234664290292e+00, 2.3458830355856741e+00, -1.0156184950387477e+00},
       {-5.7186551029639636e+00, 2.4398222489324071e+00, -5.1554787345537290e-01},
       {1.6157668819279001e+00, -9.2356117399981119e-01, -4.5554052982968525e+00},
       {1.0389317215589806e+00, 1.6006225841917949e+00, 2.6493309956329685e+00},
       {-2.0440036117608797e+00, -1.0166838989771205e+00, 2.7641766286498326e+00},
       {1.4128647525642462e+00, -4.0493640794117249e+00, 1.0581908158402780e+00},
       {-1.5468048880715091e+00, -2.5139294990524634e+00, 3.8031891474366292e-01},
       {2.6103714478205480e+00, 4.6432002266444590e+00, -4.3611393566705257e+00},
       {-1.5067111892098197e+00, -1.4345335612298595e+00, 1.7887240007480028e+00},
       {1.4992247435269457e+00, -1.4229740712215890e-02, 4.7898496435145121e+00},
       {1.4433228392382536e-01, -8.6012279693550457e+00, -3.7822278826063442e+00},
       {-2.0423866433897468e+00, -3.5983445372642215e+00, 4.4688856429001017e-01},
       {-6.9153583697531784e-01, 1.6447449599766633e+00, 4.1437722697916515e+00},
       {-1.1953665124821004e-01, -3.0782494882394231e+00, -5.1996693649932446e+00},
       {-1.5148774187094629e+00, -8.3123058158272445e-01, 3.7787231151006688e+00},
       {2.6442224693992809e+00, -2.1205650597069376e+00, 1.5394344556913447e-01},
       {-6.1394134331851968e-01, -2.4367051188094679e+00, 7.2806460347315971e-01},
       {8.5012316614949135e-01, 3.6964819121825716e+00, -8.2896253061712244e+00},
       {2.8452070391196926e+00, 2.6283905704323578e+00, 6.1271410116991987e-01},
       {-1.9666006096414026e+00, 6.5349151936717009e-01, 1.4720963692038085e+00},
       {-2.2223831649948051e+00, 3.0053183934291496e+00, -3.8955974220887075e+00},
       {9.2404568813647303e-01, -2.5118652875232517e+00, -1.1747983399971615e-01},
       {-2.5766281973032426e+00, 3.0757821120967090e+00, 3.7392045334261157e+00},
       {4.1762848145266818e-02, -2.2229217175765741e+00, 2.3626500037579512e+00},
       {-2.9237107582595128e+00, 3.8459663904409065e+00, -9.9173874896204539e-01},
       {-1.0701162028908902e+00, -1.3796231906533978e+00, 3.2162681261279942e+00},
       {-3.0137471203622170e+00, 1.4500756072331535e+00, 1.0823283786224358e+00},
       {6.4110233652047341e+00, 2.7479495161011451e+00, -2.7307702122619197e+00},
       {6.0922788374027261e+00, -1.6682433914742605e+00, -3.0284402899389673e+00},
       {3.3210167132649677e+00, -2.3201686656317664e+00, -1.3516089887732738e+00},
       {3.6302930237384379e+00, -3.5192826165347664e+00, 5.2468221053659230e+00},
       {-4.4184911171219970e-01, -6.7019630343639436e-01, 2.8137263728205850e+00},
       {2.3513682739493444e+00, 2.5422664567819941e+00, -1.0765030164218210e+00},
       {5.0343539455753783e+00, -6.4189277308909194e+00, 2.0313007601791417e+00},
       {-2.0475217695934367e+00, 1.9122503433245415e+00, -2.9054417376431746e-01},
       {-1.4371373930373090e+00, -1.4132663238321461e+00, 2.2533702948735668e+00},
       {1.9315868283933095e+00, -3.9392256420872018e-01, 2.0336372692468929e+00},
       {6.1635169356064843e+00, 3.6637881849155138e+00, 6.4959565669686068e+00},
       {9.7229325294843105e-01, 7.3164541978253501e+00, -3.4711283039815459e+00},
       {3.3471125718467176e+00, 4.9397519674567478e+00, 4.3509978078642355e+00},
       {6.0652865422250679e+00, -3.0172743674562135e+00, 4.7904522384894959e+00},
       {3.2292867413520554e-01, 2.7715234626782910e+00, -2.2894618186601892e+00},
       {6.1285206897001177e-01, 2.3865604463649186e+00, 6.4590209081289995e-01},
       {1.8934734461193905e+00, -1.7431119023097206e+00, -2.0341981270407192e+00},
       {7.8242170958840056e+00, -3.8016325042098398e+00, -2.9445786430318970e-02},
       {1.6426870867036856e+00, -2.1314055086514516e+00, -4.1659782305951853e-01},
       {-8.9729235646458150e-01, 5.1351731136006356e+00, 1.5553012553049013e+00},
       {-2.8431394069219893e+00, -3.5708888002335337e+00, 2.7450303916649665e-01},
       {-1.3040066749914840e+00, 2.9866536331260809e+00, 6.4142612784050335e-01},
       {3.2904873230247103e+00, 2.0342464767617274e+00, -3.4549669586284032e-01},
       {1.1970361681547195e+00, -1.2564626818553570e+00, -2.1966142112974620e+00},
       {-6.2187316416390432e+00, 2.3538538198672398e+00, -1.6445763256447441e+00},
       {-6.2071096124593792e+00, 1.6850397865982765e+00, -1.0563061528087319e+00},
       {-7.1969259718763050e+00, 1.4383814021977002e+00, -1.9743969330845506e+00},
       {-1.2851251026283947e+00, -9.4487567853561627e-01, 6.0194374288450598e+00},
       {3.5793210743806343e+00, -2.1250725996374531e-01, 2.2974044477021249e+00},
       {-6.8608340362919709e+00, 3.7246949714816990e+00, 1.3579880388134125e+00},
       {-8.3871776104155304e-01, -4.6775615535789294e-02, -2.6425644685181688e+00},
       {8.0790776338716108e-01, -2.4885766334783841e+00, -1.4452386671696997e+00},
       {1.7249560910599238e+00, -4.4860445610192123e-01, -2.5873534331826376e+00},
       {4.4587664576959651e-01, -2.5041932914914624e+00, -2.9197254675273543e-01},
       {2.4384607465377268e+00, 1.1759951624910028e+00, -2.9703239610393282e+00},
       {3.3249902923614911e+00, 7.6979446751015690e-01, 2.3803403736343465e-01},
       {-1.9309497679670715e+00, 2.8760666282705647e+00, -4.8474895099504929e+00},
       {-3.1066614620447946e-02, -4.7148422627546815e-01, -2.6210982655261748e+00},
       {-1.0348972777363273e-01, 2.7083700848452912e+00, -9.4813789320916564e-01},
       {3.6302819948300482e+00, -1.4810663320339915e-01, 1.3753516353675316e-01},
       {-6.0938168304511278e+00, 1.3512401307842352e+00, -2.9130373186358138e+00},
       {-1.0609473087590500e+00, 1.3109423980442860e+00, -3.5332470945360814e+00},
       {-5.2276778941893260e+00, -6.7918418420044058e-01, 3.8459503329151018e-01},
       {5.0756343609692598e+00, -3.7090723295032304e+00, -2.5913708496407368e+00},
       {6.0324874088605276e-02, -1.8999139147869426e+00, 4.0547490814190699e+00},
       {3.6440264182803670e+00, -2.7420980446559512e-01, -6.0779519344178745e-01},
       {-2.5614992155843428e+00, 6.0995380717118533e-02, 1.0930800534010812e+00},
       {3.8050794918583501e+00, 2.0682389653092197e+00, -2.7280423210026763e+00},
       {-5.6431153678006849e+00, -2.6132206167895471e+00, 2.8511799518790424e+00},
       {9.2963308206684581e-02, 5.6339593468699558e+00, -1.1717853540196979e+00},
       {-1.2045270525096503e+00, -3.7750229212350748e+00, 1.3706505573934746e-02},
       {3.6597759247630690e-01, -8.7244735087520731e-02, -3.6721203955471133e+00},
       {2.4159001659049171e+00, 2.7732238193097358e+00, -4.0893031254767500e+00},
       {-1.3961199412953773e+00, 8.5198748983578632e-01, 2.3832059055555890e+00},
       {1.4749814971331805e+00, -2.2833990393006389e+00, -3.9965368143291919e+00},
       {1.7350761232025302e+00, 2.9356792186811012e+00, -2.1492992449224024e+00},
       {-1.8483631958950262e+00, -4.1708818875367731e-01, 2.3425085447089167e+00},
       {-2.2155482634253398e+00, -9.1650802911689666e-01, -1.3671611420822773e+00},
       {2.1835276085962363e+00, -1.1054023188851394e+00, -3.7950281139142183e+00},
       {7.1317537303628900e+00, 4.5145406591378361e+00, 3.6908887624802786e+00},
       {6.5807950701430107e-01, -3.0921918358611684e+00, -3.5421629331196097e-01},
       {2.4048517591057911e-01, 5.2106966702405115e+00, 5.0479223516817653e+00},
       {1.6294113997254407e+00, -3.4133994354771549e+00, 1.0309083543194069e+00},
       {3.4576619024588456e-01, -2.7083978549820529e+00, 3.8936298732516660e-02},
       {1.2509940704857794e+00, 3.5386134910931779e+00, 5.1336921169810601e-01}};

// NOTE: for the acceleration test, we compare to accelerations computed via pyshtools
// up to degree/order 30.
TEST_CASE("acceleration")
{
    using std::cos;
    using std::sin;

    detail::edb_disabler edb;

    const auto [x, y, z] = make_vars("x", "y", "z");

    // Run a computation up to the max degree/order.
    REQUIRE_NOTHROW(
        model::egm2008_pot({x, y, z}, model::detail::egm2008_max_degree - 1u, model::detail::egm2008_max_degree - 1u));

    // Prepare input/output for the compiled functions.
    std::vector<double> out(3), in(3);
    const auto acc = model::egm2008_acc({x, y, z}, 30, 30);
    auto cf = cfunc<double>(acc, std::vector{x, y, z}, kw::compact_mode = true);

    // Construct also a version via backpropagation of the potential.
    const auto pot = model::egm2008_pot({x, y, z}, 30, 30);
    auto grad = diff_tensors({pot}, {x, y, z}).get_gradient();
    auto cf_grad = cfunc<double>(grad, std::vector{x, y, z}, kw::compact_mode = true);
    std::vector<double> out_grad(3);

    for (auto i = 0; i < 500; ++i) {
        in[0] = test_positions[i][0];
        in[1] = test_positions[i][1];
        in[2] = test_positions[i][2];
        cf(out, in);

        REQUIRE(out[0] == approximately(test_accelerations[i][0]));
        REQUIRE(out[1] == approximately(test_accelerations[i][1]));
        REQUIRE(out[2] == approximately(test_accelerations[i][2]));

        cf(out_grad, in);
        REQUIRE(out[0] == approximately(out_grad[0]));
        REQUIRE(out[1] == approximately(out_grad[1]));
        REQUIRE(out[2] == approximately(out_grad[2]));
    }
}
